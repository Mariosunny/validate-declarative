"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Errors=e;var t=exports.NON_UNIQUE_PROPERTY_ERROR="NonUniqueValueError",n=exports.INVALID_VALUE_ERROR="InvalidValueError",r=exports.MISSING_PROPERTY_ERROR="MissingPropertyError",o=exports.EXTRANEOUS_PROPERTY_ERROR="ExtraneousPropertyError";function s(e,t,n){this.type=e,this.key=t,this._value=null,this._expectedType=null,this.valueSet=!1,this.expectedTypeSet=!1,this.errors=n}function e(){this.errors=[]}s.prototype.add=function(){var e={error:this.type,key:this.key};this.valueSet&&(e.value=this._value),this.expectedTypeSet&&(e.expectedType=this._expectedType),this.errors.push(e)},s.prototype.value=function(e){return e&&(this._value=e,this.valueSet=!0),this},s.prototype.expectedType=function(e){return e&&(this._expectedType=e,this.expectedTypeSet=!0),this},e.prototype.invalidValue=function(e){return new s(n,e,this.errors)},e.prototype.nonUniqueValue=function(e){return new s(t,e,this.errors)},e.prototype.missingProperty=function(e){return new s(r,e,this.errors)},e.prototype.extraneousProperty=function(e){return new s(o,e,this.errors)},Object.defineProperty(exports,"__esModule",{value:!0}),exports.EXTRANEOUS_PROPERTY_ERROR=exports.NON_UNIQUE_PROPERTY_ERROR=exports.MISSING_PROPERTY_ERROR=exports.INVALID_VALUE_ERROR=exports.typeWithInstanceOf=exports.any=exports.nanValue=exports.undefinedValue=exports.nullValue=exports.regexp=exports.symbol=exports.date=exports.func=exports.object=exports.weakMap=exports.map=exports.list=exports.weakSet=exports.set=exports.array=exports.falsy=exports.truthy=exports.boolean=exports.positiveInt=exports.nonNegativeInt=exports.negativeInt=exports.nonPositiveInt=exports.int=exports.positiveNumber=exports.nonNegativeNumber=exports.negativeNumber=exports.nonPositiveNumber=exports.number=exports.string=exports.verify=exports.validate=void 0;var u=require("./validate"),i=require("./errors"),a=require("./types"),p=exports.validate=u.validate,l=exports.verify=u.verify,f=exports.string=a.string,x=exports.number=a.number,c=exports.nonPositiveNumber=a.nonPositiveNumber,y=exports.negativeNumber=a.negativeNumber,$=exports.nonNegativeNumber=a.nonNegativeNumber,E=exports.positiveNumber=a.positiveNumber,v=exports.int=a.int,m=exports.nonPositiveInt=a.nonPositiveInt,R=exports.negativeInt=a.negativeInt,d=exports.nonNegativeInt=a.nonNegativeInt,O=exports.positiveInt=a.positiveInt,N=exports.boolean=a.boolean,P=exports.truthy=a.truthy,T=exports.falsy=a.falsy,b=exports.array=a.array,_=exports.set=a.set,h=exports.weakSet=a.weakSet,I=exports.list=a.list,S=exports.map=a.map,g=exports.weakMap=a.weakMap,V=exports.object=a.object,M=exports.func=a.func,w=exports.date=a.date,A=exports.symbol=a.symbol,Y=exports.regexp=a.regexp,q=exports.nullValue=a.nullValue,U=exports.undefinedValue=a.undefinedValue,k=exports.nanValue=a.nanValue,j=exports.any=a.any,L=exports.typeWithInstanceOf=a.typeWithInstanceOf;n=exports.INVALID_VALUE_ERROR=i.INVALID_VALUE_ERROR,r=exports.MISSING_PROPERTY_ERROR=i.MISSING_PROPERTY_ERROR,t=exports.NON_UNIQUE_PROPERTY_ERROR=i.NON_UNIQUE_PROPERTY_ERROR,o=exports.EXTRANEOUS_PROPERTY_ERROR=i.EXTRANEOUS_PROPERTY_ERROR;Object.defineProperty(exports,"__esModule",{value:!0});var D=exports.$TYPE="$type",K=exports.$TEST="$test",W=exports.$OPTIONAL="$optional",Q=exports.$UNIQUE="$unique",C=exports.$ELEMENT="$element",G=exports.$NAME="$name",X=exports.$META="$__meta__",z=exports.$ROOT="$__root__",B=exports.$CONSTRAINTS=[K,D,W,Q],F=exports.$RESERVED_KEYS=[K,D,W,Q,C,G,X,z];Object.defineProperty(exports,"__esModule",{value:!0});var H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};exports.typeWithInstanceOf=L;f=exports.string={$test:function(e){return"string"==typeof e},$name:"string"},x=exports.number={$test:function(e){return"number"==typeof e&&!isNaN(e)},$name:"number"},c=exports.nonPositiveNumber={$type:x,$test:function(e){return e<=0},$name:"nonPositiveNumber"},y=exports.negativeNumber={$type:x,$test:function(e){return e<0},$name:"negativeNumber"},$=exports.nonNegativeNumber={$type:x,$test:function(e){return 0<=e},$name:"nonNegativeNumber"},E=exports.positiveNumber={$type:x,$test:function(e){return 0<e},$name:"positiveNumber"},v=exports.int={$type:x,$test:function(e){return Number.isInteger(e)},$name:"int"},m=exports.nonPositiveInt={$type:v,$test:function(e){return e<=0},$name:"nonPositiveInt"},R=exports.negativeInt={$type:v,$test:function(e){return e<0},$name:"negativeInt"},d=exports.nonNegativeInt={$type:v,$test:function(e){return 0<=e},$name:"nonNegativeInt"},O=exports.positiveInt={$type:v,$test:function(e){return 0<e},$name:"positiveInt"},N=exports.boolean={$test:function(e){return"boolean"==typeof e},$name:"boolean"},P=exports.truthy={$test:function(e){return!!e},$name:"truthy"},T=exports.falsy={$test:function(e){return!e},$name:"falsy"},b=exports.array={$test:function(e){return Array.isArray(e)},$name:"array"},_=exports.set={$test:function(e){return e instanceof Set},$name:"set"},h=exports.weakSet={$test:function(e){return e instanceof WeakSet},$name:"weakSet"},I=exports.list={$test:function(e){return b.$test(e)||_.$test(e)||h.$test(e)},$name:"list"},S=exports.map={$test:function(e){return e instanceof Map},$name:"map"},g=exports.weakMap={$test:function(e){return e instanceof WeakMap},$name:"weakMap"},V=exports.object={$test:function(e){return null!==e&&"object"===(void 0===e?"undefined":H(e))},$name:"object"},M=exports.func={$test:function(e){return"function"==typeof e},$name:"func"},w=exports.date={$test:function(e){return e instanceof Date},$name:"date"},A=exports.symbol={$test:function(e){return"symbol"===(void 0===e?"undefined":H(e))},$name:"symbol"},Y=exports.regexp={$test:function(e){return e instanceof RegExp},$name:"regexp"},q=exports.nullValue={$test:function(e){return null===e},$name:"nullValue"},U=exports.undefinedValue={$test:function(e){return void 0===e},$name:"undefinedValue"},k=exports.nanValue={$test:function(e){return Number.isNaN(e)},$name:"nanValue"},j=exports.any={$test:function(e){return!0},$name:"any"};function L(t){var e={$test:function(e){return null!==e&&e instanceof t}};return t.name&&(e.$name=t.name),e}Object.defineProperty(exports,"__esModule",{value:!0});H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};exports.isEqual=ne,exports.hasOwnProperty=re,exports.forOwn=oe,exports.isConstantValue=se,exports.isKeyValueObject=ue;a=require("./types");var J=require("./keys"),Z=require("deep-strict-equal"),ee=te(Z);function te(e){return e&&e.__esModule?e:{default:e}}function ne(e,t){return(0,ee.default)(e,t)}function re(e,t){return!!ue(e)&&e.hasOwnProperty(t)}function oe(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(){return!0};for(var r in e)e.hasOwnProperty(r)&&n(r)&&t(r,e[r])}function se(e){if(ue(e))for(var t in e)if(e.hasOwnProperty(t)&&(J.$RESERVED_KEYS.includes(t)||!se(e[t])))return!1;return!0}function ue(e){return!(null===e||"object"!==(void 0===e?"undefined":H(e))||a.list.$test(e)||e instanceof Map||e instanceof WeakMap)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.verify=l,exports.validate=p;var ie=require("./util");i=require("./errors"),J=require("./keys"),a=require("./types");function ae(e,t,n,r,o,s){(0,ie.isConstantValue)(t)&&!(0,ie.isEqual)(t,n)?(r.invalidValue(e).value(n).add(),pe(e,t,n,r,o)):(ve(t,n)||(r.invalidValue(e).value(n).expectedType(me(t)).add(),pe(e,t,n,r,o)),(0,ie.hasOwnProperty)(t,J.$ELEMENT)?le(e,t,n,r,o,s):fe(e,t,n,r,o,s))}function pe(t,n,e,r,o){!o&&(0,ie.isKeyValueObject)(e)&&(0,ie.forOwn)(e,function(e){(0,ie.hasOwnProperty)(n,e)||r.extraneousProperty(Re(t,e)).add()})}function le(n,e,t,r,o,s){if(a.list.$test(t)){var u=e[J.$ELEMENT];t.forEach(function(e,t){ae(n+"["+t+"]",u,e,r,o,s)})}else r.invalidValue(n).value(t).expectedType(a.list.$name).add()}function fe(u,e,i,a,p,l){xe(u,e,i,a,l),Ee(e,function(e,t){var n=u+(0===u.length?"":".")+e,r=t,o=(0,ie.hasOwnProperty)(i,e),s=i[e];ye(r)||o?o&&ae(n,r,s,a,p,l):a.missingProperty(n).add()})}function xe(e,t,n,r,o){var s=ce(e,o);if(s){for(var u=o[s],i=0;i<u.length;i++)if((0,ie.isEqual)(u[i],n))return void r.nonUniqueValue(e).value(n).add();u.push(n)}}function ce(e,t){return e=""===e?J.$ROOT:e.replace(/\[[0-9]+\]/,"[x]"),t.hasOwnProperty(e)?e:null}function ye(e){return!!e[J.$OPTIONAL]||!!(0,ie.hasOwnProperty)(e,J.$TYPE)&&ye(e[J.$TYPE])}function $e(e,t){return(0,ie.forOwn)(e,t,function(e){return!J.$CONSTRAINTS.includes(e)})}function Ee(e,t){return(0,ie.forOwn)(e,t,function(e){return!J.$RESERVED_KEYS.includes(e)})}function ve(e,t){var n=!0;if(e.hasOwnProperty(J.$ELEMENT)&&!e.hasOwnProperty(J.$TYPE)&&(n=a.list.$test(t)),e.hasOwnProperty(J.$TYPE)&&(0,ie.isKeyValueObject)(e[J.$TYPE])&&(n=ve(e[J.$TYPE],t)&&n),n&&e.hasOwnProperty(J.$TEST)){var r=e[J.$TEST];r instanceof RegExp?n=n&&a.string.$test(t)&&r.test(t):"function"==typeof r&&(n=n&&r(t))}return n}function me(e){var t=null;return e[J.$NAME]?t=e[J.$NAME]:e[J.$TEST]&&!e[J.$TYPE]&&e[J.$TEST]instanceof RegExp?t=e[J.$TEST]:e[J.$TYPE]&&(0,ie.isKeyValueObject)(e[J.$TYPE])&&(t=me(e[J.$TYPE])),t}function Re(e,t){return e+(0===e.length?"":".")+t}function de(e,t){return e+"["+t+"]"}function Oe(t){t.hasOwnProperty(J.$META)||(t[J.$META]={uniqueValues:{}},t[J.$META].reset=function(){(0,ie.forOwn)(t[J.$META].uniqueValues,function(e){t[J.$META].uniqueValues[e]=[]})},Ne("",t,t[J.$META].uniqueValues))}function Ne(n,e,r){(0,ie.isConstantValue)(e)||(e[J.$UNIQUE]?r[0===n.length?J.$ROOT:n]=[]:$e(e,function(e,t){e===J.$ELEMENT?Ne(de(n,"x"),t,r):Ne(Re(n,e),t,r)}))}function l(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];return 0===p(e,t,n).length}function p(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],r=new i.Errors;Oe(e);var o=e[J.$META];return e[J.$META]=void 0,ae("",e,t,r,n,o.uniqueValues),e[J.$META]=o,r.errors}